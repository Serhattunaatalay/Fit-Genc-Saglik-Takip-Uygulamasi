@startuml Fit-Genc-Saglik-ve-Beslenme-Takip
!theme plain
skinparam backgroundColor #ffffff
skinparam componentBackgroundColor #f8f9fa
skinparam componentBorderColor #3b82f6
skinparam componentBorderThickness 2
skinparam packageBackgroundColor #eff6ff
skinparam packageBorderColor #1e40af
skinparam packageBorderThickness 2.5
skinparam arrowColor #4b5563
skinparam arrowThickness 2
skinparam noteFontSize 10
skinparam noteBkgColor #f0fdf4
skinparam noteBorderColor #10b981

title **Fit GenÃ§ - SaÄŸlÄ±k ve Beslenme Takip UygulamasÄ±**\n**Ana Algoritma Mimarisi**

' ========== AÅAMA 1: PROFÄ°L YÃ–NETÄ°MÄ° ==========
package "1ï¸âƒ£ PROFÄ°L YÃ–NETÄ°MÄ°" #e0e7ff {
    component "ğŸ‘¤ Profil Listesi" as P1
    component "â• Yeni Profil" as P2
    component "ğŸ—‘ï¸ Profil Silme" as P3
}

' ========== AÅAMA 2: Ã–LÃ‡ÃœM GÄ°RÄ°ÅÄ° ==========
package "2ï¸âƒ£ Ã–LÃ‡ÃœM GÄ°RÄ°ÅÄ°" #dbeafe {
    component "ğŸ“ Ã–lÃ§Ã¼m Formu" as M1
    component "âœ“ Veri DoÄŸrulama" as M2
}

' ========== AÅAMA 3: ANTROPOMETRIK HESAPLALAMALAR ==========
package "3ï¸âƒ£ ANTROPOMETRIK HESAPLAMALAR" #dcfce7 {
    component "ğŸ“… YaÅŸ Hesaplama" as A1
    component "âš–ï¸ BMI" as A2
    component "ğŸ“ WHTR" as A3
    component "ğŸ’ª Kol YaÄŸ AlanÄ±" as A4
    component "ğŸ¦µ Kol Kas AlanÄ±" as A5
}

note right of A2
  **BMI FormÃ¼lÃ¼:**
  BMI = aÄŸÄ±rlÄ±k (kg) / boyÂ² (mÂ²)
  
  Persentil AralÄ±klarÄ± (WHO):
  â€¢ 3. Persentil
  â€¢ 5. Persentil
  â€¢ 15. Persentil
  â€¢ 50. Persentil (Medyan)
  â€¢ 85. Persentil
  â€¢ 95. Persentil
  â€¢ 97. Persentil
end note

note right of A3
  **WHTR FormÃ¼lÃ¼:**
  WHTR = bel Ã§evresi / boy
  
  Ä°deal: WHTR < 0.5
  
  Persentil AralÄ±klarÄ± (NCHS):
  â€¢ 5, 10, 15, 25, 50, 75, 85, 90, 95
end note

note right of A4
  **Kol YaÄŸ AlanÄ± (AFA):**
  C = (triceps mm Ã— kol Ã§evresi) / 2
  AFA = Ï€ Ã— (tricepsÂ²) / 4 - C
  
  **Kol Kas AlanÄ± (AMA):**
  AMA = ((kol Ã§evresi - Ï€ Ã— triceps)Â² / 4Ï€) - C
  
  C sabitleri (NCHS):
  â€¢ Erkek: C = 10
  â€¢ KÄ±z: C = 6.5
  
  TÃ¼m Ã¶lÃ§Ã¼mler mm cinsinden
end note

' ========== AÅAMA 4: PERSENTÄ°L ANALÄ°ZÄ° ==========
package "4ï¸âƒ£ PERSENTÄ°L ANALÄ°ZÄ° (WHO/NCHS)" #fef3c7 {
    component "ğŸ“Š YaÅŸa Uygun Veri SeÃ§imi" as PE1
    component "ğŸ” 7 Ã–lÃ§Ã¼mÃ¼ Standartlara KarÅŸÄ±laÅŸtÄ±r" as PE2
    component "ğŸ¯ Durum Belirleme" as PE3
}

note right of PE2
  **Persentil Interpolasyon:**
  if deÄŸer < min â†’ %1 Persentil (Critical)
  if deÄŸer > max â†’ %99 Persentil (Critical)
  else â†’ (p_start + p_end) / 2
  
  **Durum SÄ±nÄ±flandÄ±rmasÄ±:**
  â€¢ Critical: â‰¤3 veya â‰¥95 persentil
  â€¢ Warning: 5-15 veya 85-95 persentil
  â€¢ Ideal: 15-85 persentil
  
  **Referans StandartlarÄ±:**
  â€¢ WHO (7 persentil): 3, 5, 15, 50, 85, 95, 97
  â€¢ NCHS (9 persentil): 5, 10, 15, 25, 50, 75, 85, 90, 95
  
  7 Ã–lÃ§Ã¼m:
  Boy, AÄŸÄ±rlÄ±k, BMI, Bel, Triceps, Kol Ã‡evresi, Kol Kas AlanÄ±
end note

' ========== AÅAMA 5: BESLENME HESAPLAMA ==========
package "5ï¸âƒ£ BESLENME Ä°HTÄ°YAÃ‡ HESAPLAMA" #fce7f3 {
    component "ğŸ”§ DÃ¼zeltilmiÅŸ AÄŸÄ±rlÄ±k" as N1
    component "âš¡ Mobil AÄŸÄ±rlÄ±k" as N2
    component "ğŸ”‹ Harris-Benedict TEE" as N3
    component "ğŸ¥— Makro Besinler" as N4
}

note right of N1
  **AdÄ±m 1: DÃ¼zeltilmiÅŸ AÄŸÄ±rlÄ±k**
  dÃ¼zeltilmiÅŸ_aÄŸÄ±rlÄ±k = katsayÄ± Ã— boy(m)
  
  KatsayÄ±lar (YaÅŸ-Cinsiyet):
  â€¢ 13.0E: 18.2, 13.0K: 18.8
  â€¢ 14.0E: 19.0, 14.0K: 19.6
  â€¢ 15.0E: 19.8, 15.0K: 20.2
  â€¢ 17.6E: 21.4, 17.6K: 21.2
  (10 yaÅŸ noktasÄ± iÃ§in interpolasyon)
end note

note right of N2
  **AdÄ±m 2: Mobil AÄŸÄ±rlÄ±k**
  
  if BMI = Critical:
    mobil_aÄŸÄ±rlÄ±k = (0.75 Ã— gerÃ§ek) 
                  + (0.25 Ã— dÃ¼zeltilmiÅŸ)
    kullanÄ±lacak = mobil_aÄŸÄ±rlÄ±k
  else:
    kullanÄ±lacak = gerÃ§ek_aÄŸÄ±rlÄ±k
end note

note right of N3
  **AdÄ±m 3: Harris-Benedict FormÃ¼lÃ¼**
  
  ERKEK (E):
  TEE = (17.5 Ã— aÄŸÄ±rlÄ±k + 651) Ã— PAL
  
  KIZ (K):
  TEE = (12.2 Ã— aÄŸÄ±rlÄ±k + 746) Ã— PAL
  
  PAL (Fiziksel Aktivite Seviyesi): 1.6
  (Orta aktivite dÃ¼zeyi)
end note

note right of N4
  **AdÄ±m 4: Makro Besinler (TEE'den)**
  
  Protein = (TEE Ã— 0.18) / 4 kcal/g
  Karbohidrat = (TEE Ã— 0.52) / 4 kcal/g
  YaÄŸ = (TEE Ã— 0.30) / 9 kcal/g
  
  DaÄŸÄ±lÄ±m YÃ¼zdeleri:
  â€¢ Protein: %18
  â€¢ Karbohidrat: %52
  â€¢ YaÄŸ: %30
  
  AdÄ±m 5: Su & Lif (YaÅŸ-Cinsiyet):
  Erkek:
  â€¢ 13-13.6: 19g lif, 2.1L su
  â€¢ 14-14.6: 19g lif, 2.5L su
  â€¢ 15-17.6: 21g lif, 2.5L su
  
  KÄ±z:
  â€¢ 13-13.6: 19g lif, 1.9L su
  â€¢ 14-14.6: 19g lif, 2.0L su
  â€¢ 15-17.6: 21g lif, 2.0L su
end note

' ========== AÅAMA 6: MÄ°KRO BESÄ°NLER ==========
package "6ï¸âƒ£ MÄ°KRO BESÄ°NLERLER" #f3e8ff {
    component "ğŸ‚ YaÅŸ Grubu SeÃ§imi" as MN1
    component "ğŸ’Š Vitaminler" as MN2
    component "â›ï¸ Mineraller" as MN3
}

note right of MN1
  **Mikro Besin YaÅŸ GruplandÄ±rmasÄ±:**
  
  Grup 1: 13-14.6 yaÅŸ
  (YaÅŸlar: 13, 13.6, 14, 14.6)
  
  Grup 2: 15-17.6 yaÅŸ
  (YaÅŸlar: 15, 15.6, 16, 16.6, 17, 17.6)
  
  Ä°Ã§eriÄŸi: TÃ¼ber 2022'ye gÃ¶re
  Erkek & KÄ±z (ayrÄ± tablolar)
  
  Not: Riboflavin uyarlamasÄ±:
  â€¢ 13-13.6: 1.4 mg â†’ 13.6'dan 1.6 mg
  â€¢ 15+: 1.6 mg
end note

note right of MN2
  **Vitaminler (13 adet):**
  A, D, E, K, B1, B2, B3, B6, B12,
  Folat, C, Biotin, Pantotenik Asit
  
  Grup 1 (13-14.6):
  A: 600 mcg, D: 15 mcg, C: 70 mg
  
  Grup 2 (15-17.6):
  A: 750 mcg, D: 15 mcg, C: 100 mg
end note

note right of MN3
  **Mineraller (11 adet):**
  Kalsiyum, Fosfor, Magnezyum, Demir,
  Ã‡inko, Ä°yot, BakÄ±r, Potasyum,
  Selenyum, Flor, Manganez
  
  Grup 1 (13-14.6):
  Kalsiyum: 1150 mg
  Demir: 13 mg (her yaÅŸ)
  Ã‡inko: 10.7 mg (E) / AynÄ± (K)
  
  Grup 2 (15-17.6):
  Potasyum: 3500 mg (artÄ±ÅŸ)
  Ã‡inko: 11.9 mg (E) / AynÄ± (K)
end note

' ========== AÅAMA 7: SONUÃ‡ & RAPORLAMA ==========
package "7ï¸âƒ£ SONUÃ‡ & RAPORLAMA" #f0fdf4 {
    component "ğŸ“‹ Ã–lÃ§Ã¼m Ã–zeti" as R1
    component "ğŸ“Š Persentil GrafiÄŸi" as R2
    component "ğŸ“ˆ Trend Analizi" as R3
}

' ========== VERÄ° DEPOSU ==========
database "ğŸ’¾ DEPOLAMA" #f0f9ff {
}

' ========== ANA AKIÅ BAÄLANTILARI ==========
P1 -.-> P2 : "Yeni Ekle"
P1 -.-> M1 : "Ã–lÃ§Ã¼m GiriÅŸ"
P1 -.-> P3 : "Sil"

M1 --> M2 : "GÃ¶nder"
M2 --> A1 : "Boy, Kilo, Bel, Triceps, Kol"

A1 --> A2 : "YaÅŸ"
A1 --> A3
A1 --> A4
A1 --> A5
A2 --> A3 : "BMI"
A4 --> A5

A5 --> PE1 : "6 Ã–lÃ§Ã¼m"
PE1 --> PE2 : "Referans Veri"
PE2 --> PE3 : "Persentil DeÄŸerleri"

PE3 --> N1 : "BMI Durumu"
A1 --> N1 : "YaÅŸ-Cinsiyet\nKatsayÄ±sÄ±"
N1 --> N2 : "DÃ¼zeltilmiÅŸ AÄŸÄ±rlÄ±k"
N2 --> N3 : "KullanÄ±lacak AÄŸÄ±rlÄ±k"
N3 --> N4 : "TEE Enerji"

A1 --> MN1 : "YaÅŸ Grubu"
MN1 --> MN2 : "13-14.6 veya 15-17.6"
MN1 --> MN3

PE3 --> R1 : "7 Ã–lÃ§Ã¼m\nPersentili"
N4 --> R1 : "Makro Besinler"
MN2 --> R1
MN3 --> R1

R1 --> R2 : "Veriler"
R2 --> R3 : "Trend"

R1 --> DEPOLAMA : "Kaydet"
P2 --> DEPOLAMA : "Kaydet"
R3 --> DEPOLAMA : "Kaydet"
DEPOLAMA -.-> P1 : "YÃ¼kle"


note bottom of P1
  **Merkez NoktasÄ±:**
  TÃ¼m iÅŸlemler buradan baÅŸlar
end note

note right of A1
  **YaÅŸ Hesaplama FormÃ¼lÃ¼:**
  rawAge = (now - birthDate) / (365.25 Ã— 24 Ã— 60 Ã— 60 Ã— 1000)
  
  OndalÄ±k DÃ¶nemlendirilme:
  â€¢ decimal < 0.3 â†’ floor(age)
  â€¢ 0.3 â‰¤ decimal < 0.8 â†’ floor(age) + 0.6
  â€¢ decimal â‰¥ 0.8 â†’ floor(age) + 1
  
  Ã‡Ä±kÄ±ÅŸ: 13, 13.6, 14, ..., 17.6
end note

note right of N3
  **Harris-Benedict FormÃ¼lÃ¼**
  TEE = (a Ã— aÄŸÄ±rlÄ±k + b) Ã— PAL
  
  Erkek:  (17.5 Ã— kg + 651) Ã— 1.6
  KÄ±z:    (12.2 Ã— kg + 746) Ã— 1.6
  
  PAL = 1.6 (orta aktivite)
end note

note right of DEPOLAMA
  **Browser LocalStorage:**
  
  Depolanan Veri YapÄ±sÄ±:
  {
    profileId: string,
    studentName: string,
    gender: 'male' | 'female',
    birthDate: ISO date string,
    measurements: [
      {
        date: ISO datetime,
        height: number (cm),
        weight: number (kg),
        waist: number (cm),
        triceps: number (mm),
        armCirc: number (cm),
        results: {
          age: number (13, 13.6, 14...),
          bmi: number,
          whtr: number,
          afa: number,
          ama: number,
          percentiles: { ... },
          nutrition: { ... }
        }
      }
    ]
  }
  
  Referans VeritabanlarÄ±:
  â€¢ WHO Persentilleri (7 nokta)
  â€¢ NCHS Persentilleri (9 nokta)
  â€¢ Harris-Benedict Sabitleri
  â€¢ KatsayÄ± TablolarÄ± (10 yaÅŸ noktasÄ±)
  â€¢ Mikro Besin DeÄŸerleri (TÃ¼ber 2022)
end note

@enduml
